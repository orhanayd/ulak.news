!function($,undefined){jPlayerPlaylist=function(cssSelector,playlist,options){var self=this;this.current=0,this.loop=!1,this.shuffled=!1,this.removing=!1,this.cssSelector=$.extend({},this._cssSelector,cssSelector),this.options=$.extend(!0,{keyBindings:{next:{key:221,fn:function(){self.next()}},previous:{key:219,fn:function(){self.previous()}},shuffle:{key:83,fn:function(){self.shuffle()}}},stateClass:{shuffled:"jp-state-shuffled"}},this._options,options),this.playlist=[],this.original=[],this._initPlaylist(playlist),this.cssSelector.details=this.cssSelector.cssSelectorAncestor+" .jp-details",this.cssSelector.playlist=this.cssSelector.cssSelectorAncestor+" .jp-playlist",this.cssSelector.next=this.cssSelector.cssSelectorAncestor+" .jp-next",this.cssSelector.previous=this.cssSelector.cssSelectorAncestor+" .jp-previous",this.cssSelector.shuffle=this.cssSelector.cssSelectorAncestor+" .jp-shuffle",this.cssSelector.shuffleOff=this.cssSelector.cssSelectorAncestor+" .jp-shuffle-off",this.options.cssSelectorAncestor=this.cssSelector.cssSelectorAncestor,this.options.repeat=function(event){self.loop=event.jPlayer.options.loop},$(this.cssSelector.jPlayer).bind($.jPlayer.event.ready,(function(){self._init()})),$(this.cssSelector.jPlayer).bind($.jPlayer.event.ended,(function(){self.next()})),$(this.cssSelector.jPlayer).bind($.jPlayer.event.play,(function(){$(this).jPlayer("pauseOthers")})),$(this.cssSelector.jPlayer).bind($.jPlayer.event.resize,(function(event){event.jPlayer.options.fullScreen?$(self.cssSelector.details).show():$(self.cssSelector.details).hide()})),$(this.cssSelector.previous).click((function(e){e.preventDefault(),self.previous(),self.blur(this)})),$(this.cssSelector.next).click((function(e){e.preventDefault(),self.next(),self.blur(this)})),$(this.cssSelector.shuffle).click((function(e){e.preventDefault(),self.shuffled&&$(self.cssSelector.jPlayer).jPlayer("option","useStateClassSkin")?self.shuffle(!1):self.shuffle(!0),self.blur(this)})),$(this.cssSelector.shuffleOff).click((function(e){e.preventDefault(),self.shuffle(!1),self.blur(this)})).hide(),this.options.fullScreen||$(this.cssSelector.details).hide(),$(this.cssSelector.playlist+" ul").empty(),this._createItemHandlers(),$(this.cssSelector.jPlayer).jPlayer(this.options)},jPlayerPlaylist.prototype={_cssSelector:{jPlayer:"#jquery_jplayer_1",cssSelectorAncestor:"#jp_container_1"},_options:{playlistOptions:{autoPlay:!1,loopOnPrevious:!1,shuffleOnLoop:!0,enableRemoveControls:!1,displayTime:"slow",addTime:"fast",removeTime:"fast",shuffleTime:"slow",itemClass:"jp-playlist-item",freeGroupClass:"jp-free-media",freeItemClass:"jp-playlist-item-free",removeItemClass:"jp-playlist-item-remove"}},option:function(option,value){if(void 0===value)return this.options.playlistOptions[option];switch(this.options.playlistOptions[option]=value,option){case"enableRemoveControls":this._updateControls();break;case"itemClass":case"freeGroupClass":case"freeItemClass":case"removeItemClass":this._refresh(!0),this._createItemHandlers()}return this},_init:function(){var self=this;this._refresh((function(){self.options.playlistOptions.autoPlay?self.play(self.current):self.select(self.current)}))},_initPlaylist:function(playlist){this.current=0,this.shuffled=!1,this.removing=!1,this.original=$.extend(!0,[],playlist),this._originalPlaylist()},_originalPlaylist:function(){var self=this;this.playlist=[],$.each(this.original,(function(i){self.playlist[i]=self.original[i]}))},_refresh:function(instant){var self=this;if(instant&&!$.isFunction(instant))$(this.cssSelector.playlist+" ul").empty(),$.each(this.playlist,(function(i){$(self.cssSelector.playlist+" ul").append(self._createListItem(self.playlist[i]))})),this._updateControls();else{var displayTime=$(this.cssSelector.playlist+" ul").children().length?this.options.playlistOptions.displayTime:0;$(this.cssSelector.playlist+" ul").slideUp(displayTime,(function(){var $this=$(this);$(this).empty(),$.each(self.playlist,(function(i){$this.append(self._createListItem(self.playlist[i]))})),self._updateControls(),$.isFunction(instant)&&instant(),self.playlist.length?$(this).slideDown(self.options.playlistOptions.displayTime):$(this).show()}))}},_createListItem:function(media){var self=this,listItem="<li><div class='info-wrapper'>";if(listItem+="<a href='javascript:;' class='"+this.options.playlistOptions.removeItemClass+"'>&times;</a>",media.free){var first=!0;listItem+="<span class='"+this.options.playlistOptions.freeGroupClass+"'>(",$.each(media,(function(property,value){$.jPlayer.prototype.format[property]&&(first?first=!1:listItem+=" | ",listItem+="<a class='"+self.options.playlistOptions.freeItemClass+"' href='"+value+"' tabindex='-1'>"+property+"</a>")})),listItem+=")</span>"}return listItem+="<a href='javascript:;' class='"+this.options.playlistOptions.itemClass+"' tabindex='0'>"+(media.title?" <span class='jp-title'> "+media.title+"</span> ":"")+(media.artist?" <span class='jp-artist'>- "+media.artist+"</span> ":"")+(media.duration?" <span class='time'> "+media.duration+"</span>":"")+"</a>",listItem+="</div></li>"},_createItemHandlers:function(){var self=this;$(this.cssSelector.playlist).off("click","a."+this.options.playlistOptions.itemClass).on("click","a."+this.options.playlistOptions.itemClass,(function(e){e.preventDefault();var index=$(this).parent().parent().index();self.current!==index?self.play(index):$(self.cssSelector.jPlayer).jPlayer("play"),self.blur(this)})),$(this.cssSelector.playlist).off("click","a."+this.options.playlistOptions.freeItemClass).on("click","a."+this.options.playlistOptions.freeItemClass,(function(e){e.preventDefault(),$(this).parent().parent().find("."+self.options.playlistOptions.itemClass).click(),self.blur(this)})),$(this.cssSelector.playlist).off("click","a."+this.options.playlistOptions.removeItemClass).on("click","a."+this.options.playlistOptions.removeItemClass,(function(e){e.preventDefault();var index=$(this).parent().parent().index();self.remove(index),self.blur(this)}))},_updateControls:function(){this.options.playlistOptions.enableRemoveControls?$(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).show():$(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).hide(),this.shuffled?$(this.cssSelector.jPlayer).jPlayer("addStateClass","shuffled"):$(this.cssSelector.jPlayer).jPlayer("removeStateClass","shuffled"),$(this.cssSelector.shuffle).length&&$(this.cssSelector.shuffleOff).length&&(this.shuffled?($(this.cssSelector.shuffleOff).show(),$(this.cssSelector.shuffle).hide()):($(this.cssSelector.shuffleOff).hide(),$(this.cssSelector.shuffle).show()))},_highlight:function(index){this.playlist.length&&void 0!==index&&($(this.cssSelector.playlist+" .jp-playlist-current").removeClass("jp-playlist-current"),$(this.cssSelector.playlist+" li:nth-child("+(index+1)+")").addClass("jp-playlist-current").find(".jp-playlist-item").addClass("jp-playlist-current"))},setPlaylist:function(playlist){this._initPlaylist(playlist),this._init()},add:function(media,playNow){$(this.cssSelector.playlist+" ul").append(this._createListItem(media)).find("li:last-child").hide().slideDown(this.options.playlistOptions.addTime),this._updateControls(),this.original.push(media),this.playlist.push(media),playNow?this.play(this.playlist.length-1):1===this.original.length&&this.select(0)},remove:function(index){var self=this;return void 0===index?(this._initPlaylist([]),this._refresh((function(){$(self.cssSelector.jPlayer).jPlayer("clearMedia")})),!0):!this.removing&&(0<=(index=index<0?self.original.length+index:index)&&index<this.playlist.length&&(this.removing=!0,$(this.cssSelector.playlist+" li:nth-child("+(index+1)+")").slideUp(this.options.playlistOptions.removeTime,(function(){if($(this).remove(),self.shuffled){var item=self.playlist[index];$.each(self.original,(function(i){if(self.original[i]===item)return self.original.splice(i,1),!1})),self.playlist.splice(index,1)}else self.original.splice(index,1),self.playlist.splice(index,1);self.original.length?index===self.current?(self.current=index<self.original.length?self.current:self.original.length-1,self.select(self.current)):index<self.current&&self.current--:($(self.cssSelector.jPlayer).jPlayer("clearMedia"),self.current=0,self.shuffled=!1,self._updateControls()),self.removing=!1}))),!0)},select:function(index){0<=(index=index<0?this.original.length+index:index)&&index<this.playlist.length?(this.current=index,this._highlight(index),$(this.cssSelector.jPlayer).jPlayer("setMedia",this.playlist[this.current])):this.current=0},play:function(index){0<=(index=index<0?this.original.length+index:index)&&index<this.playlist.length?this.playlist.length&&(this.select(index),$(this.cssSelector.jPlayer).jPlayer("play")):void 0===index&&$(this.cssSelector.jPlayer).jPlayer("play")},pause:function(){$(this.cssSelector.jPlayer).jPlayer("pause")},next:function(){var index=this.current+1<this.playlist.length?this.current+1:0;this.loop?0===index&&this.shuffled&&this.options.playlistOptions.shuffleOnLoop&&this.playlist.length>1?this.shuffle(!0,!0):this.play(index):index>0&&this.play(index)},previous:function(){var index=this.current-1>=0?this.current-1:this.playlist.length-1;(this.loop&&this.options.playlistOptions.loopOnPrevious||index<this.playlist.length-1)&&this.play(index)},shuffle:function(shuffled,playNow){var self=this;void 0===shuffled&&(shuffled=!this.shuffled),(shuffled||shuffled!==this.shuffled)&&$(this.cssSelector.playlist+" ul").slideUp(this.options.playlistOptions.shuffleTime,(function(){self.shuffled=shuffled,shuffled?self.playlist.sort((function(){return.5-Math.random()})):self._originalPlaylist(),self._refresh(!0),playNow||!$(self.cssSelector.jPlayer).data("jPlayer").status.paused?self.play(0):self.select(0),$(this).slideDown(self.options.playlistOptions.shuffleTime)}))},blur:function(that){$(this.cssSelector.jPlayer).jPlayer("option","autoBlur")&&$(that).blur()}}}(jQuery);